id: dsq-1955296103
message: "Great tip! I also use this macro.\r\n\r\nAnd this is my modification of the macro:\r\n\r\nPublic Module AttachToAspNet  \r\n Declare Function SetForegroundWindow Lib \"user32\" (ByVal hwnd As Long) As Long\r\n\r\n Declare Function keybd_event Lib \"user32\" (ByVal bVk As Byte, ByVal bScan As Byte, _  \r\n ByVal dwFlags As Long, ByVal dwExtraInfo As Long) As Long\r\n\r\n Const VK_F5 = &H74\r\n\r\n Function RefreshIE(ByVal ifRefresh As Boolean)  \r\n Dim process As System.Diagnostics.Process  \r\n Dim processes As System.Diagnostics.Process()  \r\n processes = System.Diagnostics.Process.GetProcesses()  \r\n For Each process In processes  \r\n If (process.ProcessName = \"iexplore\") Then  \r\n SetForegroundWindow(process.MainWindowHandle.ToInt32())  \r\n If ifRefresh Then  \r\n keybd_event(VK_F5, 0, 0, 0)  \r\n End If  \r\n Exit Function  \r\n End If  \r\n Next  \r\n End Function\r\n\r\n Function GetAspNetWpProcessID() As Integer  \r\n Dim process As System.Diagnostics.Process  \r\n Dim processes As System.Diagnostics.Process()  \r\n processes = System.Diagnostics.Process.GetProcesses()  \r\n For Each process In processes  \r\n If (process.ProcessName = \"aspnet_wp\") Then  \r\n Return process.Id  \r\n End If  \r\n Next  \r\n Return -1  \r\n End Function\r\n\r\n Sub AttachToAspNet()  \r\n Dim process As EnvDTE.Process\r\n\r\n Dim aspnet_wpProcessID As Integer  \r\n aspnet_wpProcessID = GetAspNetWpProcessID()  \r\n If aspnet_wpProcessID = -1 Then  \r\n Exit Sub  \r\n End If\r\n\r\n For Each process In DTE.Debugger.DebuggedProcesses  \r\n If (process.ProcessID = aspnet_wpProcessID) Then  \r\n Exit Sub  \r\n End If  \r\n Next\r\n\r\n For Each process In DTE.Debugger.LocalProcesses  \r\n If (process.ProcessID = aspnet_wpProcessID) Then  \r\n process.Attach()  \r\n If MsgBox(\"Refresh IE?\", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then  \r\n RefreshIE(True)  \r\n Exit Sub  \r\n End If  \r\n End If  \r\n Next  \r\n End Sub  \r\nEnd Module"
name: Anonymous
date: 2006-11-13T19:58:00.0000000+01:00
avatar: https://disqus.com/api/users/avatars/Anonymous.jpg
replyToId: 
